<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Pokémon GO - Calendrier Filtrable Dynamique</title>
<style>
  body { font-family: Arial, sans-serif; margin:30px; background:#f8f9fa; color:#333; }
  .container { max-width:900px; margin:auto; padding:25px; background:#fff; border-radius:15px; box-shadow:0 8px 25px rgba(0,0,0,0.2); }
  .header-box { padding:15px; border:2px solid #1565c0; border-radius:12px; background:#e3f2fd; margin-bottom:20px; text-align:center; }
  .header-box h1 { margin:0; color:#1565c0; }
  .header-box p { margin:5px 0 0; font-size:0.95em; color:#222; }

  .tags-grid { display:grid; grid-template-columns:repeat(auto-fit, minmax(220px,1fr)); gap:12px; margin-bottom:20px; }
  .tag { padding:12px; border-radius:10px; display:flex; align-items:center; border:2px solid #000; transition:transform 0.2s, box-shadow 0.3s; cursor:pointer; }
  .tag input { transform: scale(1.2); margin-right:8px; }
  .tag label { font-weight:bold; cursor:pointer; }
  .tag:hover { transform:scale(1.05); box-shadow:0 0 20px 5px rgba(21,101,192,0.6); border-color:#1565c0; }

  button { display:block; margin:20px auto; padding:12px 20px; background:#1565c0; color:white; border:none; border-radius:8px; cursor:pointer; font-size:16px; font-weight:bold; transition:0.3s; }
  button:hover { background:#0d47a1; transform:scale(1.03); }

  #linkContainer { margin-top:20px; text-align:center; font-size:0.95em; }
  #linkContainer div { display:inline-block; background:#f1f1f1; padding:10px; border-radius:8px; }
  #linkContainer a { color:#1565c0; text-decoration:none; font-weight:bold; }
  #linkContainer a:hover { text-decoration:underline; }
  #linkContainer button { background:#1565c0; color:white; border:none; border-radius:5px; padding:5px 10px; margin-top:10px; cursor:pointer; display:block; margin-left:auto; margin-right:auto; }

  #lexique { margin-top:35px; overflow-x:auto; }
  #lexique h3 { margin-bottom:12px; color:#444; text-align:center; }
  table { width:100%; border-collapse:collapse; font-size:0.9em; min-width:700px; border:2px solid #000; }
  table th, table td { border:1px solid #000; padding:10px; text-align:left; transition:background 0.3s; }
  table th { background:#1565c0; color:white; text-align:center; }
  table tr:hover { cursor:pointer; }

  /* Couleurs tags / lexique harmonisées */
  .tag-RH, .lex-RH { background-color:#ffebee; }
  .tag-RB, .lex-RB { background-color:#ffe0b2; }
  .tag-PSH, .lex-PSH { background-color:#e1f5fe; }
  .tag-CD, .lex-CD { background-color:#e8f5e9; }
  .tag-GBL, .lex-GBL { background-color:#f3e5f5; }
  .tag-WA, .lex-WA { background-color:#fff9c4; }
  .tag-E, .lex-E { background-color:#fce4ec; }
  .tag-S, .lex-S { background-color:#d7ccc8; }
  .tag-MM, .lex-MM { background-color:#c8e6c9; }
  .tag-RD, .lex-RD { background-color:#ffccbc; }
  .tag-RW, .lex-RW { background-color:#d1c4e9; }
  .tag-GP, .lex-GP { background-color:#b3e5fc; }
  .tag-CS, .lex-CS { background-color:#ffe082; }

  .highlight { outline:3px solid #1565c0; transition:outline 0.3s; transform:scale(1.05); }

  /* Badges abréviations */
  .abbr-RH { background:#ffebee; padding:2px 6px; border-radius:4px; }
  .abbr-RB { background:#ffe0b2; padding:2px 6px; border-radius:4px; }
  .abbr-PSH { background:#e1f5fe; padding:2px 6px; border-radius:4px; }
  .abbr-CD { background:#e8f5e9; padding:2px 6px; border-radius:4px; }
  .abbr-GBL { background:#f3e5f5; padding:2px 6px; border-radius:4px; }
  .abbr-WA { background:#fff9c4; padding:2px 6px; border-radius:4px; }
  .abbr-E { background:#fce4ec; padding:2px 6px; border-radius:4px; }
  .abbr-S { background:#d7ccc8; padding:2px 6px; border-radius:4px; }
  .abbr-MM { background:#c8e6c9; padding:2px 6px; border-radius:4px; }
  .abbr-RD { background:#ffccbc; padding:2px 6px; border-radius:4px; }
  .abbr-RW { background:#d1c4e9; padding:2px 6px; border-radius:4px; }
  .abbr-GP { background:#b3e5fc; padding:2px 6px; border-radius:4px; }
  .abbr-CS { background:#ffe082; padding:2px 6px; border-radius:4px; }

  footer { margin-top:40px; text-align:center; color:#666; font-size:0.9em; }
</style>
</head>
<body>
<div class="container">
  <div class="header-box">
    <h1>Pokémon GO - Sélection des événements</h1>
    <p>Cochez les événements à inclure dans votre calendrier, puis cliquez sur <strong>Générer mon calendrier</strong>.<br>
    <span>Sur mobile, cliquez sur le lien ICS pour ajouter le calendrier directement. Modifiez le titre, choisissez la couleur, activez les alertes et cliquez sur "Ajouter".</span></p>
  </div>

  <div class="tags-grid" id="tagsGrid"></div>

  <button onclick="generateLink()">Générer mon calendrier</button>
  <p id="linkContainer"></p>

  <div id="lexique">
    <h3>Lexique des tags</h3>
    <table id="lexTable">
      <thead>
        <tr><th>Abréviation</th><th>Nom anglais</th><th>Nom français</th><th>Description</th></tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>

  <footer>by SneakyOnTv</footer>
</div>

<script>
// Données des tags et lexique
const tagsData = [
  {id:"RH", label:"Raid Hour", labelFR:"Heure de Raid", desc:"Raids spéciaux concentrés sur un Pokémon.", color:"#ffebee"},
  {id:"RB", label:"Raid Boss", labelFR:"Boss de Raid", desc:"Pokémon disponible en tant que boss de raid.", color:"#ffe0b2"},
  {id:"PSH", label:"Pokémon Spotlight Hour", labelFR:"Heure vedette Pokémon", desc:"Apparition accrue d’un Pokémon spécifique.", color:"#e1f5fe"},
  {id:"CD", label:"Community Day", labelFR:"Journée Communautaire", desc:"Événement avec un Pokémon vedette et des bonus spéciaux.", color:"#e8f5e9"},
  {id:"GBL", label:"GO Battle League", labelFR:"Ligue de Combat GO", desc:"Combats PvP avec règles et récompenses.", color:"#f3e5f5"},
  {id:"WA", label:"Wild Area", labelFR:"Zone Sauvage", desc:"Apparitions spéciales dans la nature.", color:"#fff9c4"},
  {id:"E", label:"Event", labelFR:"Événement", desc:"Événement global ou local.", color:"#fce4ec"},
  {id:"S", label:"Tales of Transformation", labelFR:"Transformation fabuleuse", desc:"Événement spécial avec des Pokémon et mécaniques uniques.", color:"#d7ccc8"},
  {id:"MM", label:"Max Monday", labelFR:"Lundi Max", desc:"Raids Dynamax spéciaux.", color:"#c8e6c9"},
  {id:"RD", label:"Raid Day", labelFR:"Journée de Raids", desc:"Raids concentrés sur un Pokémon particulier.", color:"#ffccbc"},
  {id:"RW", label:"Raid Weekend", labelFR:"Week-end de Raids", desc:"Raids intensifs sur plusieurs jours.", color:"#d1c4e9"},
  {id:"GP", label:"GO Pass", labelFR:"Passe GO", desc:"Suit votre progression pendant une période donnée.", color:"#b3e5fc"},
  {id:"CS", label:"City Safari", labelFR:"Safari en Ville", desc:"Événement spécial dans certaines villes.", color:"#ffe082"},
];

// Génération dynamique tags
const tagsGrid=document.getElementById("tagsGrid");
tagsData.forEach(tag=>{
  const div=document.createElement("div");
  div.className=`tag tag-${tag.id}`;
  div.style.backgroundColor=tag.color;
  div.innerHTML=`<input type="checkbox" id="${tag.id}" name="tags" value="${tag.id}"><label for="${tag.id}">[${tag.id}] ${tag.label}</label>`;
  tagsGrid.appendChild(div);
});

// Génération lexique
const lexBody=document.querySelector("#lexTable tbody");
tagsData.forEach(tag=>{
  const tr=document.createElement("tr");
  tr.className=`lex-${tag.id} clickable-row`;
  tr.dataset.tag=tag.id;
  tr.style.backgroundColor=tag.color;
  tr.innerHTML=`<td class="abbr-${tag.id}">[${tag.id}]</td><td>${tag.label}</td><td>${tag.labelFR}</td><td>${tag.desc}</td>`;
  lexBody.appendChild(tr);
});

// Fonction générer lien
function generateLink(){
  const selectedTags=Array.from(document.querySelectorAll('input[name="tags"]:checked')).map(e=>e.value);
  if(selectedTags.length===0){ alert("Veuillez cocher au moins un événement !"); return; }
  const baseURL="https://pokemon-go-calendar-fr.vercel.app/api/calendar?tags=";
  const finalURL=baseURL + encodeURIComponent(selectedTags.join(","));
  const container=document.getElementById("linkContainer");
  container.innerHTML=`<div>
    <p>Voici votre lien ICS :</p>
    <a href="${finalURL}" target="_blank">${finalURL}</a>
    <button onclick="copyLink('${finalURL}')">Copier le lien</button>
  </div>`;
}

function copyLink(url){ navigator.clipboard.writeText(url).then(()=>alert("Lien copié !")).catch(()=>alert("Impossible de copier le lien.")); }

// Survol TR lexique => glow sur tag
document.querySelectorAll('.clickable-row').forEach(row=>{
  row.addEventListener('mouseenter', ()=>highlightTag(row.dataset.tag,true));
  row.addEventListener('mouseleave', ()=>highlightTag(row.dataset.tag,false));
});

function highlightTag(tag,state){
  if(!tag) return;
  document.querySelectorAll(`.tag-${tag}`).forEach(el=>{
    if(state){ el.classList.add('highlight'); } 
    else { el.classList.remove('highlight'); }
  });
}

// Clic sur TR = coche/décoche checkbox
document.querySelectorAll('.clickable-row').forEach(row=>{
  row.addEventListener('click', ()=>{
    const tag=row.dataset.tag;
    const checkbox=document.getElementById(tag);
    if(checkbox) checkbox.checked=!checkbox.checked;
  });
});

// Checkbox modifie lexique highlight
document.querySelectorAll('input[name="tags"]').forEach(cb=>{
  cb.addEventListener('change', ()=>{
    const tag=cb.id;
    document.querySelectorAll(`.lex-${tag}`).forEach(r=>{
      if(cb.checked) r.classList.add('highlight'); else r.classList.remove('highlight');
    });
  });
});
</script>
</body>
</html>
